# Values for Infisical (Secure Deployment)
infisical-standalone:
  infisical:
    replicaCount: 1
    kubeSecretRef: "infisical-secrets"
    service:
      type: ClusterIP
    
  ingress:
    enabled: true
    ingressClassName: nginx
    hostName: infisical.buildin.group
    annotations:
      nginx.ingress.kubernetes.io/proxy-body-size: "100m"
      gethomepage.dev/enabled: "true"
      gethomepage.dev/name: "Infisical"
      gethomepage.dev/description: "Secret Management Platform"
      gethomepage.dev/icon: "infisical.png"
      gethomepage.dev/group: "Security"
      gethomepage.dev/weight: "10"
    
  # Disable bundled charts
  postgresql:
    enabled: false
    # Tell Infisical to use our secret for the connection string
    useExistingPostgresSecret:
      enabled: true
      existingConnectionStringSecret:
        name: "infisical-secrets"
        key: "DB_CONNECTION_URI"

  redis:
    enabled: false
    # Redis URL will be picked up from envFrom (infisical-secrets)
    # because the bundled redis is disabled, the chart won't override it.

# Configure top-level PostgreSQL dependency
postgresql:
  enabled: true
  auth:
    username: infisical
    database: infisicalDB
    existingSecret: "infisical-secrets"
    secretKeys:
      userPasswordKey: "postgres-password"
  primary:
    persistence:
      size: 1Gi

# Configure top-level Redis dependency
redis:
  enabled: true
  auth:
    existingSecret: "infisical-secrets"
    existingSecretPasswordKey: "redis-password"
  master:
    persistence:
      size: 1Gi
  architecture: standalone